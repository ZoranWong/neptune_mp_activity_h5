{"version":3,"sources":["config/app.js","utils/request.js","components/ShareButton.js","css/product.js","components/Products.js","api/home.js","components/CustomHeader.js","App.js","serviceWorker.js","index.js"],"names":["app","apiUrl","apiPrefix","tokenKey","storageUserKey","service","Axios","create","baseURL","Config","headers","Accept","timeout","interceptors","request","use","config","error","Promise","reject","response","data","undefined","code","message","console","log","status","ShareButton","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","image","setState","react_default","a","createElement","src","alt","mode","style","width","height","Component","productStyle","productsStyle","background","boxSizing","padding","transform","borderTopLeftRadius","borderTopRightRadius","liStyle","display","justifyContent","alignItems","borderBottom","imageStyle","flex","flexDirection","marginLeft","h3Style","fontSize","color","fontWeight","marginTop","marginBottom","descStyle","tagStyle","border","borderRadius","fontStyle","priceStyle","leftStyle","iStyle","h4Style","margin","spanStyle","textDecoration","imgStyle","Products","checkInCart","e","p","stopPropagation","products","productsInCart","length","isInCart","inCartProduct","i","product","changeBuyNum","id","addToCart","num","params","product_stock_id","buy_num","token","url","method","then","r","refresh","cart","concat","productDetail","window","wx","miniProgram","navigateTo","_this2","ids","_this3","map","index","key","onClick","name","CustomHeader","App","catch","_","caculateCartQuantity","quantity","Number","getQueryVariable","variable","vars","location","search","substring","split","pair","renderTemplate","template","components_ShareButton","components_Products","goShoppingCart","actId","templates","title","statusHeight","mainHeight","getActInfo","postMessage","_this$state","className","position","components_CustomHeader","overflow","left","bottom","top","right","Boolean","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"+MAGeA,EAAA,CACXC,OAAS,4BACTC,UAAY,GACZC,SAAS,eACTC,eAAe,yBCFbC,EAAUC,IAAMC,OAAO,CACzBC,QAASC,EAAOR,OAAS,IAAMQ,EAAOP,UACtCQ,QAAS,CACLC,OAAU,OAEdC,QAASH,EAAOG,UAGpBP,EAAQQ,aAAaC,QAAQC,IACzB,SAAAC,GAEI,OADAA,EAAON,QAAP,cAAkC,GAC3BM,GAEX,SAAAC,GACIC,QAAQC,OAAOF,KAMvBZ,EAAQQ,aAAaO,SAASL,IAC1B,SAAAK,GACC,OAAOA,EAASC,MAEjB,SAAAJ,GACF,QAAcK,IAAVL,GAAsC,QAAfA,EAAMM,KAEhC,OADAC,IAAQP,MAAM,8CACPC,QAAQC,OAAOF,GAHZ,IAKHG,EAAaH,EAAbG,SAER,OADAK,QAAQC,IAAIN,EAAU,YAClBA,GAAaA,EAASO,QAG1BH,IAAQP,MAAMG,EAASC,KAAKG,SAC5BA,IAAQP,MAAMG,EAASC,KAAKG,SACfN,QAAQC,OAAOF,SAL5B,IASaZ,YCrBAuB,cArBX,SAAAA,EAAYC,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAL,IACfE,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAH,GAAAQ,KAAAH,KAAMJ,KACDQ,MAAQ,CACTC,MAAO,IAHIR,mFASfG,KAAKM,SAAS,CAACD,MAAOL,KAAKJ,MAAMR,wCAIjC,OACImB,EAAAC,EAAAC,cAAA,WACIF,EAAAC,EAAAC,cAAA,OAAKC,IAAKV,KAAKI,MAAMC,MAAOM,IAAI,GAAGC,KAAK,WAAWC,MAAO,CAACC,MAAO,OAAQC,OAAQ,kBAhBxEC,aCFbC,EAAe,CACxBC,cAAe,CACXJ,MAAO,OACPK,WAAY,OACZC,UAAW,aACXC,QAAS,SACTC,UAAW,oBACXC,oBAAqB,OACrBC,qBAAsB,QAE1BC,QAAU,CACNX,MAAO,OACPO,QAAS,YACTK,QAAS,OACTC,eAAgB,gBAChBC,WAAY,SACZC,aAAc,oBACdT,UAAW,cAEfU,WAAY,CACRhB,MAAO,QACPC,OAAQ,SAEZE,aAAc,CACVc,KAAM,IACNL,QAAS,OACTC,eAAgB,SAChBC,WAAY,aACZI,cAAe,SACfC,WAAY,OACZb,UAAW,cAEfc,QAAS,CACLC,SAAU,OACVC,MAAO,OACPC,WAAY,OACZC,UAAW,MACXC,aAAc,OAElBC,UAAW,CACPL,SAAU,OACVC,MAAO,QAEXK,SAAU,CACNpB,QAAU,QACVe,MAAO,UACPM,OAAQ,oBACRC,aAAc,MACdL,UAAW,MACXH,SAAU,MACVS,UAAW,UAEfC,WAAY,CACR/B,MAAO,OACPY,QAAS,OACTC,eAAgB,gBAChBC,WAAY,YAEhBkB,UAAW,CACPpB,QAAS,OACTC,eAAgB,aAChBC,WAAY,YAEhBmB,OAAQ,CACJZ,SAAU,OACVC,MAAO,UACPC,WAAY,OACZf,UAAW,mBACXsB,UAAW,UAEfI,QAAS,CACLb,SAAU,OACVC,MAAO,UACPC,WAAY,OACZY,OAAQ,GAEZC,UAAW,CACPf,SAAU,OACVC,MAAO,OACPe,eAAgB,eAChBlB,WAAY,MACZX,UAAW,oBAEf8B,SAAU,CACNtC,MAAO,OACPC,OAAQ,SCODsC,cAvFX,SAAAA,EAAYzD,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAqD,IACfxD,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAuD,GAAAlD,KAAAH,KAAMJ,KAaV0D,YAAc,SAACC,EAAEC,GACbD,EAAEE,kBACF,IAAIC,EAAW7D,EAAKD,MAAM+D,eAC1B,GAAID,EAASE,OAAQ,CAGjB,IAFA,IAAIC,GAAW,EACXC,EAAgB,GACXC,EAAI,EAAGA,EAAIL,EAASE,OAAQG,IAAK,CACtC,IAAIC,EAAUN,EAASK,GACvB,GAAIC,EAAO,mBAAyBR,EAAC,iBAAsB,CACvDK,GAAW,EACXC,EAAgBE,EAChB,MAEAH,GAAW,EAGfA,EACAhE,EAAKoE,aAAaH,EAAcI,GAAIJ,EAAa,QAAc,GAE/DjE,EAAKsE,UAAUX,EAAC,iBAAsB,QAG1C3D,EAAKsE,UAAUX,EAAC,iBAAsB,IApC3B3D,EAwCnBsE,UAAY,SAACD,EAAIE,GCbd,IAA0BC,KDcR,CAACC,iBAAkBJ,EAAGK,QAAS,EAAGC,MAAO3E,EAAKD,MAAM4E,OCbrE3F,EAAQ,CACd4F,IAAK,oBACLC,OAAQ,OACRtF,KAAMiF,KDU6EM,KAAK,SAAAC,GAC9E/E,EAAKD,MAAMiF,QAAQhF,EAAKD,MAAM4E,UA1CnB3E,EA6CnBoE,aAAe,SAACC,EAAIE,GCTjB,IAA6BC,EAAOS,GAAPT,EDUR,CAACE,QAASH,EAAKI,MAAO3E,EAAKD,MAAM4E,OCVlBM,EDU0BZ,ECT7DrF,EAAQ,CACd4F,IAAG,qBAAAM,OAAuBD,GAC1BJ,OAAQ,MACRtF,KAAMiF,KDMiEM,KAAK,SAAAC,GAClE/E,EAAKD,MAAMiF,QAAQhF,EAAKD,MAAM4E,UA/CnB3E,EAmDnBmF,cAAgB,SAAChB,GACbiB,OAAOC,GAAGC,YAAYC,WAAW,CAC7BX,IAAG,iDAAAM,OAAmDf,EAAO,eAnDjEnE,EAAKO,MAAQ,CACTsD,SAAU,IAHC7D,mFAQC,ICFOwE,EDEPgB,EAAArF,MCFOqE,EDGR,CAACiB,IAAKtF,KAAKJ,MAAMR,MCFhCP,EAAQ,CACd4F,IAAG,4BACHC,OAAQ,MACRL,OAAQA,KDDqCM,KAAK,SAAAC,GACxCS,EAAK/E,SAAS,CAACoD,SAAUkB,EAAExF,0CA+C1B,IAAAmG,EAAAvF,KACA0D,EAAY1D,KAAKI,MAAjBsD,SACL,OACInD,EAAAC,EAAAC,cAAA,WACIF,EAAAC,EAAAC,cAAA,MAAII,MAAOI,EAAaC,eACnBwC,EAASE,QAAUF,EAAS8B,IAAI,SAACxB,EAASyB,GAAV,OAC7BlF,EAAAC,EAAAC,cAAA,MAAKI,MAAOI,EAAaQ,QAASiE,IAAKD,EAAOE,QAAS,kBAAIJ,EAAKP,cAAchB,KAC1EzD,EAAAC,EAAAC,cAAA,OAAKI,MAAOI,EAAaa,WAAapB,IAAKsD,EAAO,cAAP,eAA2C3D,MAAOM,IAAI,KACjGJ,EAAAC,EAAAC,cAAA,OAAKI,MAAOI,EAAaA,cACrBV,EAAAC,EAAAC,cAAA,MAAII,MAAOI,EAAaiB,SAAU8B,EAAO,cAAP,eAA2C4B,MAC7ErF,EAAAC,EAAAC,cAAA,QAAMI,MAAOI,EAAauB,WAA1B,2BACAjC,EAAAC,EAAAC,cAAA,QAAMI,MAAOI,EAAauB,WAA1B,gBAAyCwB,EAAO,cAAP,4BACzCzD,EAAAC,EAAAC,cAAA,MAAII,MAAOI,EAAawB,UAAxB,4BACAlC,EAAAC,EAAAC,cAAA,OAAKI,MAAOI,EAAa4B,YACrBtC,EAAAC,EAAAC,cAAA,OAAKI,MAAOI,EAAa6B,WACrBvC,EAAAC,EAAAC,cAAA,KAAGI,MAAOI,EAAa8B,QAAvB,UACAxC,EAAAC,EAAAC,cAAA,MAAII,MAAOI,EAAa+B,SAAUgB,EAAO,WACzCzD,EAAAC,EAAAC,cAAA,QAAMI,MAAOI,EAAaiC,WAA1B,SAAuCc,EAAO,cAAP,8BAE3CzD,EAAAC,EAAAC,cAAA,OAAKI,MAAOI,EAAamC,SAAUuC,QAAS,SAACpC,GAAD,OAAKgC,EAAKjC,YAAYC,EAAES,IAAUtD,IAAI,YAAYC,IAAI,mBA7E/GK,aEYR6E,8LAZPrG,QAAQC,IAAIO,KAAKJ,wCAIjB,OACIW,EAAAC,EAAAC,cAAA,OAAKI,MAAO,CAACC,MAAO,OAAQC,OAAQf,KAAKJ,MAAMmB,OAAS,KAAMW,QAAS,OAAQC,eAAgB,aAAaC,WAAY,SAAUT,WAAW,UAAWE,QAAS,SAAUD,UAAW,uBAPvKJ,aCqJZ8E,cA/IX,SAAAA,EAAYlG,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAA8F,IACfjG,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAgG,GAAA3F,KAAAH,KAAMJ,KA2BViF,QAAU,SAACL,GFhBR,IAAqBH,KEiBR,CAACG,SFhBb3F,EAAQ,CACd4F,IAAK,oBACLC,OAAQ,MACRL,OAAQA,KEamBM,KAAK,SAAAC,GACtB/E,EAAKS,SAAS,CAACqD,eAAgBiB,EAAExF,SAClC2G,MAAM,SAAAC,OA/BMnG,EAkCnBoG,qBAAuB,WAGnB,IAFA,IAAIC,EAAW,EACXxC,EAAW7D,EAAKO,MAAMuD,eACjBI,EAAI,EAAGA,EAAIL,EAASE,OAAQG,IACjCmC,GAAYC,OAAOzC,EAASK,GAAT,SAEvB,OAAOmC,GAxCQrG,EA2CnBuG,iBAAmB,SAACC,GAGhB,IAFA,IACIC,EADQrB,OAAOsB,SAASC,OAAOC,UAAU,GAC5BC,MAAM,KACd3C,EAAE,EAAEA,EAAEuC,EAAK1C,OAAOG,IAAK,CAC5B,IAAI4C,EAAOL,EAAKvC,GAAG2C,MAAM,KACzB,GAAGC,EAAK,IAAMN,EAAU,OAAOM,EAAK,GAExC,OAAO,GAlDQ9G,EAqDnB+G,eAAiB,SAACC,GACd,IAAIjH,EAAQ,CACRR,KAAMyH,EAASzH,KACfsG,IAAKmB,EAASjB,KACdpB,MAAO3E,EAAKO,MAAMoE,MAClBb,eAAgB9D,EAAKO,MAAMuD,eAC3BkB,QAAShF,EAAKgF,SAElB,OAAQgC,EAASjB,MACb,IAAK,eACD,OAAOrF,EAAAC,EAAAC,cAACqG,EAAgBlH,GAC5B,IAAK,WACD,OAAOW,EAAAC,EAAAC,cAACsG,EAAanH,GACzB,QACI,MAAO,KAnEAC,EAuEnBmH,eAAiB,WACb/B,OAAOC,GAAGC,YAAYC,WAAW,CAC7BX,IAAK,mCAvET5E,EAAKO,MAAQ,CACT6G,MAAO,GACP7H,KAAM,GACN8H,UAAW,GACXC,MAAO,GACPxD,eAAgB,GAChBa,MAAO,GACP4C,aAAc,GATHvH,mFAeC,IAAAwF,EAAArF,KACZqE,EAASrE,KAAKoG,iBAAiB,eAC/B5B,EAAQxE,KAAKoG,iBAAiB,SAC9BgB,EAAepH,KAAKoG,iBAAiB,cACrCiB,EAAarH,KAAKoG,iBAAiB,cACvCpG,KAAKM,SAAS,CAAC2G,MAAO5C,EAAOG,QAAM4C,eAAaC,cAAa,WACzDhC,EAAKR,QAAQL,KF3BlB,SAAoBH,EAAOH,GACjC,OAAOrF,EAAQ,CACd4F,IAAG,sBAAAM,OAAwBb,GAC3BQ,OAAQ,MACRL,OAAQA,IEyBFiD,CAAW,GAAIjD,GAAQM,KAAK,SAAAC,GACxBS,EAAK/E,SAAS,CAAClB,KAAMwF,EAAExF,KAAM8H,UAAWtC,EAAExF,KAAKyH,SAAUM,MAAOvC,EAAExF,KAAKwG,SACxEG,MAAM,SAAAC,qDAqDTf,OAAOC,GAAGC,YAAYoC,YAAY,CAACnI,KAAM,8CAGpC,IAAAmG,EAAAvF,KAAAwH,EACqBxH,KAAKI,MAAxB8G,EADFM,EACEN,UAAUC,EADZK,EACYL,MAqCjB,OACI5G,EAAAC,EAAAC,cAAA,OAAKgH,UAAU,MAAM5G,MAAO,CAAC6G,SAAU,aACnCnH,EAAAC,EAAAC,cAACkH,EAAD,CAAcR,MAAOA,EAAOpG,OAAQf,KAAKI,MAAMgH,eAC/C7G,EAAAC,EAAAC,cAAA,OAAKI,MAAO,CAACE,OAAQf,KAAKI,MAAMiH,WAAa,KAAMO,SAAU,SAErDV,EAAU1B,IAAI,SAAAqB,GACV,OAAOtB,EAAKqB,eAAeC,KAGnCtG,EAAAC,EAAAC,cAAA,OAAKI,MA7CA,CACb6G,SAAU,QACVG,KAAM,OACNC,OAAQ,QACRhH,MAAO,OACPC,OAAQ,OACR4B,aAAc,MACdxB,WAAY,qBACZO,QAAS,OACTC,eAAgB,SAChBC,WAAY,UAmCkB+D,QAAS3F,KAAKgH,gBAChCzG,EAAAC,EAAAC,cAAA,OAAKC,IAAI,mBAAmBG,MAAO,CAACC,MAAO,OAAQC,OAAQ,QAASJ,IAAI,KAEpEX,KAAKI,MAAMuD,eAAeC,OAASrD,EAAAC,EAAAC,cAAA,QAAMI,MA1BrC,CACpB6G,SAAU,WACVK,IAAK,MACLC,MAAO,OACPlH,MAAO,OACPC,OAAQ,OACR4B,aAAc,OACdxB,WAAY,UACZiB,MAAO,OACPM,OAAQ,iBACRhB,QAAS,OACTC,eAAgB,SAChBC,WAAY,WAeK5B,KAAKiG,wBACD,IAGb1F,EAAAC,EAAAC,cAAA,OAAKI,MAzCG,CAChBC,MAAO,OACPC,OAAQ,OACRW,QAAS,OACTC,eAAgB,SAChBC,WAAY,SACZT,WAAY,UACZgB,SAAU,OACVC,MAAO,YAiCC,qDAzIFpB,aCKEiH,QACW,cAA7BhD,OAAOsB,SAAS2B,UAEe,UAA7BjD,OAAOsB,SAAS2B,UAEhBjD,OAAOsB,SAAS2B,SAASC,MACvB,2DCZNC,IAASC,OAAO9H,EAAAC,EAAAC,cAAC6H,EAAD,MAASC,SAASC,eAAe,SD2H3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMhE,KAAK,SAAAiE,GACjCA,EAAaC","file":"static/js/main.294a47ef.chunk.js","sourcesContent":["\n\n\nexport default {\n    apiUrl : 'http://neptune.klsfood.cn',\n    apiPrefix : \"\",\n    tokenKey:'ACCESS_TOKEN',\n    storageUserKey:'USER_STORAGE',\n}\n","import Axios from 'axios'\nimport Config from '../config/app.js'\nimport { message  } from 'antd';\nimport React from \"react\";\n\nconst service = Axios.create({\n    baseURL: Config.apiUrl + '/' + Config.apiPrefix,\n    headers: {\n        'Accept': '*/*'\n    },\n    timeout: Config.timeout\n});\n\nservice.interceptors.request.use(\n    config => {\n        config.headers['Authorization'] = '';\n        return config\n    },\n    error => {\n        Promise.reject(error)\n    }\n);\n\n\n\nservice.interceptors.response.use(\n    response => {//Grade\n    \treturn response.data;\n    },\n    error => {\n\t\tif (error === undefined || error.code === '502') {\n\t\t\tmessage.error(\"服务器请求超时\");\n\t\t\treturn Promise.reject(error)\n\t\t}\n\t\tconst { response } = error;\n\t\tconsole.log(response, '========');\n\t\tif(!response || !response.status) return;\n\t\t\n\t\t\n\t\tmessage.error(response.data.message);// 弹出后端返回的错误\n\t\tmessage.error(response.data.message);\n        return Promise.reject(error)//千万不能去掉，，，否则请求超时会进入到then方法，导致逻辑错误。\n\t}\n);\n\nexport default service\n","import React, { Component } from 'react';\n\nclass ShareButton extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            image: ''\n        }\n    }\n    \n    \n    componentDidMount() {\n        this.setState({image: this.props.data})\n    }\n    \n    render() {\n        return (\n            <div>\n                <img src={this.state.image} alt=\"\" mode=\"widthFix\" style={{width: '100%', height: 'auto'}} />\n            </div>\n        );\n    }\n}\n\nexport default ShareButton;\n","export const productStyle = {\n    productsStyle: {\n        width: '100%',\n        background: '#fff',\n        boxSizing: 'border-box',\n        padding: '0 10px',\n        transform: 'translateY(-35px)',\n        borderTopLeftRadius: '10px',\n        borderTopRightRadius: '10px',\n    },\n    liStyle : {\n        width: '100%',\n        padding: '15px 10px',\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        borderBottom: '1px solid #f2f2f2',\n        boxSizing: 'border-box',\n    },\n    imageStyle: {\n        width: '114px',\n        height: '114px'\n    },\n    productStyle: {\n        flex: '1',\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'flex-start',\n        flexDirection: 'column',\n        marginLeft: '15px',\n        boxSizing: 'border-box'\n    },\n    h3Style: {\n        fontSize: '15px',\n        color: '#111',\n        fontWeight: 'bold',\n        marginTop: '2px',\n        marginBottom: '6px'\n    },\n    descStyle: {\n        fontSize: '12px',\n        color: '#999'\n    },\n    tagStyle: {\n        padding:  '0 4px',\n        color: '#fb4e26',\n        border: '1px solid #ffb7a9',\n        borderRadius: '3px',\n        marginTop: '4px',\n        fontSize: '9px',\n        fontStyle: 'normal'\n    },\n    priceStyle: {\n        width: '100%',\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'flex-end',\n    },\n    leftStyle: {\n        display: 'flex',\n        justifyContent: 'flex-start',\n        alignItems: 'flex-end'\n    },\n    iStyle: {\n        fontSize: '12px',\n        color: '#FC3C2F',\n        fontWeight: 'bold',\n        transform: 'translateY(-2px)',\n        fontStyle: 'normal',\n    },\n    h4Style: {\n        fontSize: '16px',\n        color: '#FC3C2F',\n        fontWeight: 'bold',\n        margin: 0\n    },\n    spanStyle: {\n        fontSize: '11px',\n        color: '#999',\n        textDecoration: 'line-through',\n        marginLeft: '5px',\n        transform: 'translateY(-1px)'\n    },\n    imgStyle: {\n        width: '24px',\n        height: '24px'\n    }\n};\n","import React, { Component } from 'react';\nimport {productStyle} from '../css/product';\nimport { getProductInfo, addProductToCart, changeProductBuyNum, getCartInfo } from '../api/home';\n\nclass Products extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            products: []\n        }\n    }\n    \n    \n    componentDidMount() {\n        getProductInfo({ids: this.props.data}).then(r=>{\n            this.setState({products: r.data})\n        })\n    }\n    \n    checkInCart = (e,p) => {\n        e.stopPropagation();\n        let products = this.props.productsInCart;\n        if (products.length) {\n            let isInCart = false;\n            let inCartProduct = {};\n            for (let i = 0; i < products.length; i++) {\n                let product = products[i];\n                if (product['product_stock_id'] === p['product_stock_id']) {\n                    isInCart = true;\n                    inCartProduct = product;\n                    break\n                } else {\n                    isInCart = false\n                }\n            }\n            if (isInCart) {\n                this.changeBuyNum(inCartProduct.id, inCartProduct['buy_num'] + 1)\n            } else {\n                this.addToCart(p['product_stock_id'], 1)\n            }\n        } else {\n            this.addToCart(p['product_stock_id'], 1)\n        }\n    };\n    \n    addToCart = (id, num) => {\n        addProductToCart({product_stock_id: id,buy_num: 1, token: this.props.token}).then(r=>{\n            this.props.refresh(this.props.token);\n        })\n    };\n    changeBuyNum = (id, num) => {\n        changeProductBuyNum({buy_num: num, token: this.props.token}, id).then(r=>{\n            this.props.refresh(this.props.token);\n        })\n    };\n    \n    productDetail = (product) => {\n        window.wx.miniProgram.navigateTo({\n            url: `/pages/user/goodDetail/main?type=mall&good_id=${product['product_id']}`,\n        })\n    };\n    \n    render() {\n        let {products} = this.state;\n        return (\n            <div>\n                <ul style={productStyle.productsStyle}>\n                    {products.length && products.map((product, index) => (\n                        <li  style={productStyle.liStyle} key={index} onClick={()=>this.productDetail(product)}>\n                            <img style={productStyle.imageStyle}  src={product['product_stock']['product_entity'].image} alt=\"\" />\n                            <div style={productStyle.productStyle}>\n                                <h3 style={productStyle.h3Style}>{product['product_stock']['product_entity'].name}</h3>\n                                <span style={productStyle.descStyle}>净含量:384g</span>\n                                <span style={productStyle.descStyle}>销量:{product['product_stock']['product_entity']['total_sales']}</span>\n                                <em style={productStyle.tagStyle}>新人专享</em>\n                                <div style={productStyle.priceStyle}>\n                                    <div style={productStyle.leftStyle}>\n                                        <i style={productStyle.iStyle}>￥</i>\n                                        <h4 style={productStyle.h4Style}>{product['act_price']}</h4>\n                                        <span style={productStyle.spanStyle}>￥{product['product_stock']['product_entity']['retail_price']}</span>\n                                    </div>\n                                    <img style={productStyle.imgStyle} onClick={(e)=>this.checkInCart(e,product)} src=\"./add.png\" alt=\"\" />\n                                </div>\n                            </div>\n                        </li>\n                    ))}\n                </ul>\n            </div>\n        );\n    }\n}\n\nexport default Products;\n","import request from '../utils/request'\n\nexport function getActInfo(params,id) {\n\treturn request({\n\t\turl: `/api/mp/activities/${id}`,\n\t\tmethod: 'get',\n\t\tparams: params\n\t})\n}\n\n// 根据id 获取商品详情信息\nexport function getProductInfo(params) {\n\treturn request({\n\t\turl: `/api/mp/activity/products`,\n\t\tmethod: 'get',\n\t\tparams: params\n\t})\n}\n\n// 获取当前购物车\nexport function getCartInfo(params) {\n\treturn request({\n\t\turl: 'api/mp/mall/carts',\n\t\tmethod: 'get',\n\t\tparams: params\n\t})\n}\n\n// 添加商品进购物车let response = await this.httpPost('api/mp/mall/carts', {\n//             product_stock_id: id,\n//             buy_num: num\n//         });\nexport function addProductToCart(params) {\n\treturn request({\n\t\turl: 'api/mp/mall/carts',\n\t\tmethod: 'post',\n\t\tdata: params\n\t})\n}\n\n// 修改购物车商品数量\nexport function changeProductBuyNum(params,cart) {\n\treturn request({\n\t\turl: `api/mp/mall/carts/${cart}`,\n\t\tmethod: 'put',\n\t\tdata: params\n\t})\n}\n","import React, { Component } from 'react';\n\nclass CustomHeader extends Component {\n    componentDidMount () {\n        console.log(this.props);\n    }\n    \n    render() {\n        return (\n            <div style={{width: '100%', height: this.props.height + 'px', display: 'flex', justifyContent: 'flex-start',alignItems: 'center', background:'#f6f6f6', padding: '0 10px', boxSizing: 'border-box'}}>\n            \n            </div>\n        );\n    }\n}\n\nexport default CustomHeader;\n","import './App.css';\nimport React, { Component } from 'react';\nimport {getActInfo, getCartInfo} from './api/home';\nimport ShareButton from './components/ShareButton';\nimport Products from './components/Products';\nimport CustomHeader from './components/CustomHeader';\n\nclass App extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            actId: [],\n            data: {},\n            templates: [],\n            title: '',\n            productsInCart: [],\n            token: '',\n            statusHeight: 0\n        };\n    }\n\n\n\n    componentDidMount() {\n        let params = this.getQueryVariable('activity_id');\n        let token = this.getQueryVariable('token');\n        let statusHeight = this.getQueryVariable('headHeight');\n        let mainHeight = this.getQueryVariable('mainHeight');\n        this.setState({actId: params,token,statusHeight,mainHeight}, ()=>{\n            this.refresh(token);\n        });\n        getActInfo({}, params).then(r=>{\n            this.setState({data: r.data, templates: r.data.template, title: r.data.name})\n        }).catch(_=>{});\n    }\n    \n    refresh = (token) => {\n        getCartInfo({token}).then(r=>{\n            this.setState({productsInCart: r.data})\n        }).catch(_=>{})\n    };\n    \n    caculateCartQuantity = () => {\n        let quantity = 0;\n        let products = this.state.productsInCart;\n        for (let i = 0; i < products.length; i++ ) {\n            quantity += Number(products[i]['buy_num'])\n        }\n        return quantity\n    };\n    \n    getQueryVariable = (variable) => {\n        let query = window.location.search.substring(1);\n        let vars = query.split(\"&\");\n        for (var i=0;i<vars.length;i++) {\n            var pair = vars[i].split(\"=\");\n            if(pair[0] == variable){return pair[1];}\n        }\n        return(false);\n    };\n    \n    renderTemplate = (template) => {\n        let props = {\n            data: template.data,\n            key: template.name,\n            token: this.state.token,\n            productsInCart: this.state.productsInCart,\n            refresh: this.refresh\n        };\n        switch (template.name) {\n            case 'SHARE_BUTTON':\n                return <ShareButton {...props} />;\n            case 'PRODUCTS':\n                return <Products {...props} />;\n            default :\n                return ''\n        }\n    };\n    \n    goShoppingCart = () => {\n        window.wx.miniProgram.navigateTo({\n            url: '/pages/user/ShoppingCart/main',\n        })\n    };\n    \n    componentWillUnmount() {\n        window.wx.miniProgram.postMessage({data: 'xxxxxxxx'})\n    }\n    \n    render() {\n        const {templates,title} = this.state;\n        const imgStyle = {\n            position: 'fixed',\n            left: '20px',\n            bottom: '125px',\n            width: '48px',\n            height: '48px',\n            borderRadius: '50%',\n            background: 'rgba(17,17,17,0.3)',\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n        };\n        const bottomStyle = {\n            width: '100%',\n            height: '40px',\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n            background: '#f4f1f4',\n            fontSize: '11px',\n            color: '#b3b3b3'\n        };\n        const cartLengthStyle = {\n            position: 'absolute',\n            top: '4px',\n            right: '-5px',\n            width: '20px',\n            height: '20px',\n            borderRadius: '100%',\n            background: '#FE3B32',\n            color: '#fff',\n            border: '1px solid #fff',\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center'\n        };\n        return (\n            <div className=\"App\" style={{position: 'relative'}}>\n                <CustomHeader title={title} height={this.state.statusHeight} />\n                <div style={{height: this.state.mainHeight + 'px', overflow: 'auto'}}>\n                    {\n                        templates.map(template => {\n                            return this.renderTemplate(template)\n                        })\n                    }\n                    <div style={imgStyle} onClick={this.goShoppingCart}>\n                        <img src=\"./white_cart.png\" style={{width: '24px', height: '24px'}} alt=\"\"/>\n                        {\n                            this.state.productsInCart.length ? <span style={cartLengthStyle} >\n                            {this.caculateCartQuantity()}\n                        </span>: ''\n                        }\n                    </div>\n                    <div style={bottomStyle}>- 我是有底线的 -</div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}